<!DOCTYPE HTML>
<html>

<head>
	<title>Kyle Josling</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
	<link rel="stylesheet" href="assets/css/main.css" />
	<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	<link rel="icon" href="favicon.ico?" type="x-icon">
</head>

<body id="top">
	<header id="header">
		<a href="index.html" class="image avatar"><img src="images/IMG_0350.jpg" alt="" /></a>
		<p>
		<h1>
		<strong>
			Kyle Josling
		</strong>
	</h1>
	<h1>
			Developer
				<br>
		</h1>
	</p>
	</header>

	<div id="main">

		<section id="one">
			<header class="major">
				<h2> Object Tracking Drone</h2>
			</header>
			<img src="images/flyingdrone2.png" class="projectOverlayImage">
			<img src="images/drone.gif" class="projectOverlayImage">

		</section>

		<section id="two">

			<h3> Goal </h3>
			<p> Create an autonomous drone from scratch that can detect and follow coloured objects.</p>

			<h3> Overview </h3>
			<p> Code and CAD models for this project are<a href="https://github.com/KyleJosling/drone-with-facial-detection"> here</a></p>
            <p> The ROS package for the ARDrone is <a href="https://github.com/KyleJosling/ardrone_object_tracking">here</a></p>
			<p>After I decided to build a drone from scratch using an Arduino UNO as the flight controller, I decided to take on a bit more of a challenge. I used a Raspberry Pi with OpenCV for the computer vision component of the project. I used serial communication
				to interface the Raspberry Pi and (now) a BetaFlight flight controller, which is much more stable than the Arduino I was using before was. The Raspberry Pi detects and objects and sends the position to the flight controller via the Multiwii Serial Protocol. Based on the position of object in the frame, PID controllers move the drone so as to place the object in the
				middle of the image frame, at a certain distance away. </p>
			
			<h3> Technologies Used </h3>
			<li>OpenCV</li>
			<li>Multithreading in C++</li>
			<li>BetaFlight flight controller</li>
			<li>Raspberry Pi </li>
			<li>CAD and 3D printing</li>
			<li>ROS</li>
			<br>
			<h2> Project Log</h2>
			<h3> IT WORKS (4/9/2019) </h3>
            <p> Oh baby, it works. After a struggling a bit, I fixed some software bugs and tuned the PID controllers, and it works (dare I even say it) WELL. I'm happy to finally validate my algorithm in real life and see an end result. I have some ideas for more things I could add to this project (implement an optical flow sensor + ultrasonic to the drone I built and get the algorithm working on there), but I'm going to focus on other projects for now. </p>
			<h3> AR Drone (2/4/2019) </h3>
			<p> Since it started snowing, haven't been able to test the drone a lot since November. In the meantime though, I bought an AR drone. I plan on implementing the same object tracking algorithm using their API. The AR drone removes the difficulties of achieving a stable hover and lets me focus on the image processing and tracking algorithms. It also is essentially the same as my own drone with a stable hover, except the computer isn't on board. </p>
			<!--<p> I don't think this project was a waste of time. But when I started it almost two years ago, I had no idea how much work it would entail. I barely knew anything about control systems for UAVs, computer vision, embedded systems, 3D printing or multithreaded programs. I don't think I fully grasped how challenging a project like this was. My attitude was to build everything from scratch and essentially reinvent the wheel with this project (I built a <b>flight controller</b> from scratch!) At this point I've realised that to make this drone truly autonomous, I'll probably need more sensors - an optical flow sensor to keep the drone at a stable hover, as well as implementing an ultrasonic sensor and probably getting a new flight controller. This will probably cost 100s of dollars. </p>
         <p> I guess what I'm trying to say is as time went on, this project went from being a passion of mine to a burden I always had on my shoulders. I spent a lot of time and money on it, so I wanted to finish it. When we are growing up, we are always told to never give up, but I don't think that statement always rings true. I started this project to learn, and I learned so much! I want to put my time into other projects that I'm more passionate about right now. </p>
         <p> I'd still like to maybe implement a cheap optical flow sensor and an ultrasonic sensor to achieve a stable hover, but that may not happen until later on. The next update will be a video of the AR drone following objects. </p>-->
			<p> </p>
			<h3> Testing V2 and Tuning PID Controllers (11/11/2018) </h3>
			<p> So now that the software is pretty much complete, I spent the weekend tuning the PID controllers for all axes and the altitude hold mode. Since the software only controls the pitch and yaw components of the drone, the drone should be able to hover almost still, especially in the roll and Z directions, which aren't controlled by software.</p>
			<img src="images/IMG_2041.jpg" class="projectPageImage rotateImg mx-auto d-block">
			<p> The drone is flying super well with the new flight controller and better centre of gravity. Planning on testing an autonomous hover sometime this week, to get an appropriate height for the drone. </p>
			<h3> Designing new Components (10/19/2018)</h3>
			<p> I realized if this things gonna fly well, it needs a lower and more centred centre of gravity. See CAD models and pictures below.</p> 
			<img src="images/Pi-Battery-Assem.PNG" class="projectPageImage mx-auto d-block">
			<img src="images/IMG_2038.jpg" class="projectPageImage mx-auto d-block">

			<h3> Software Rebuild (9/26/2018) </h3>
			<p> Made the software WAY better using CMake as a build tool (I was using g++ before smh). I realized my motor control loop needed to run faster as well for the new flight controller, so I wrote a multithreaded program where one thread handles image processing and one thread handles the motor control. I'm getting about 30fps with this new software!</p>
			<h3> New Flight Controller (08/15/2018) </h3>
			<p> Took a break from this project for a while. After attempting to make a new flight controller out of an Arduino Nano, sensors and a protoboard, I found that the thing was way less stable then I wanted it to be. I was getting a lot of I2C errors and sensor problems. I decided to bite the bullet and buy a BetaFlight controller. This is a 32 bit controller instead of an 8 bit one, which means its much more stable. It also has an onboard gyro/accelerometer/barometer.</p> 
			<img src="images/IMG_2016.jpg" class="projectPageImage mx-auto d-block">
			<img src="images/IMG_2015.jpg" class="projectPageImage mx-auto d-block">
			<p> RIP :(. I liked the idea of almost the whole drone being built from scratch, including the flight controller, but some things are better off bought. I might do a PCB design of a flight controller in the future.</p> 
			<h3> First Test (21/01/2018) </h3>
			<p> This is the first test of the drone I did, using an Arduino Uno, before I switched to a real flight controller. Only the yaw PID is active. </p>
	<iframe width="560" height="315" src="https://www.youtube.com/embed/tss9761EzTk" frameborder="0" style="padding-bottom:20px" allow="autoplay; encrypted-media" allowfullscreen></iframe>


		</section>
</div>
		<!-- Footer -->
		<footer id="footer">
			<ul class="icons">
				<li><a href="https://www.linkedin.com/in/kylejosling/" class="icon fa-linkedin" target="_blank"><span class="label">Linkedin</span></a></li>
				<li><a href="https://github.com/KyleJosling" class="icon fa-github" target="_blank"><span class="label">Github</span></a></li>
			</ul>
		</footer>



		<!-- Scripts -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.poptrox.min.js"></script>
		<script src="assets/js/skel.min.js"></script>
		<script src="assets/js/util.js"></script>
		<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
		<script src="assets/js/main.js"></script>

</body>

</html>
